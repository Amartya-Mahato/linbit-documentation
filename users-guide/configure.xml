<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
  <chapter id="ch-configure">
    <title>Configuring DRBD</title>
    <section id="s-prepare-storage">
      <title>Preparing your lower-level storage</title>
      <para>After you have installed DRBD, you must set aside a
	roughly identically sized storage area on both cluster nodes.
	This will become the <emphasis>lower-level device</emphasis>
	for your DRBD resource. You may use any type of block device
	found on your system for this purpose. Typical examples
	include:
	<itemizedlist>
	  <listitem>
	    <para>A hard drive partition (or a full physical hard
	      drive),</para>
	  </listitem>
	  <listitem>
	    <para>a software RAID device,</para>
	  </listitem>
	  <listitem>
	    <para>an LVM Logical Volume or any other block device
	      configured by the Linux device-mapper
	      infrastructure,</para>
	  </listitem>
	  <listitem>
	    <para>an EVMS volume,</para>
	  </listitem>
	  <listitem>
	    <para>any other block device type found on your
	      system.</para>
	  </listitem>
	</itemizedlist>
      </para>
      <note>
	<para>While it is possible to use loop devices as lower-level
	devices for DRBD, doing so is not recommended due to deadlock
	issues.</para>
	<para>Also, DRBD does not support device stacking, meaning you
	cannot use one DRBD device as a lower-level device for
	another.</para>
      </note>
      <para>It is <emphasis>not</emphasis> necessary for this storage
      area to be empty before you create a DRBD resource from it. In
      fact it is a common use case to create a two-node cluster from a
      previously non-redundant single-server system using DRBD (some
	caveats apply &ndash; please refer to <xref
      linkend="s-metadata"/> if you are planning to do this).</para>
      <para>For the purposes of this introductory howto, we assume a
	very simple setup:
	<itemizedlist>
	  <listitem>
	    <para>Both hosts have free partition named
	    <filename>/dev/sdb1</filename>.</para>
	  </listitem>
	  <listitem>
	    <para>We are using <link
	    linkend="s-internal-meta-data">internal meta
	    data</link>.</para>
	  </listitem>
	</itemizedlist>
      </para>
    </section>
    <section id="s-prepare-network">
      <title>Preparing your network configuration</title>
    </section>
    <section id="s-config-file">
      <title>The DRBD configuration file</title>
      <para>All aspects of DRBD are controlled by a single
	configuration file, <filename>/etc/drbd.conf</filename>. You
	should always make sure this configuration file is
	<emphasis>exactly identical</emphasis> on both participating
	cluster nodes.
      </para>
      <note>
	<para>This section describes only those aspects of the
	  configuration file which most users encounter in everyday
	  operation. The configuration file's syntax contents are
	  documented in great detail in <xref
	    linkend="re-drbdconf"/>.</para>
      </note>
    </section>
  </chapter>
